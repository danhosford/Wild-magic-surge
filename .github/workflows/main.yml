name: DevAutomation

on:
  workflow_dispatch

jobs:
  list-files:
    runs-on: ubuntu-latest
    outputs:
      paths: ${{ steps.list-files.outputs.paths }}
    steps:
      - name: Expose git commit data
        uses: rlespinasse/git-commit-data-action@v1
      - name: List Files
        id: list-files
        uses: mirko-felice/list-files-action@v3.0.5
        with:
          repo: ${{ github.repository }}
          ref: ${{ github.ref }}
          path: "flyway"
          ext: ".sql"
  Test:
    runs-on: ubuntu-latest
    needs: list-files
    steps:
      - name: Output results
        uses: distributhor/workflow-webhook@v3
        with:
          webhook_url: 'https://prod-128.westus.logic.azure.com:443/workflows/9bc9eeb5dc234a2699de6acf23f20d78/triggers/manual/paths/invoke?api-version=2016-06-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=KpuKjTetiZPpJbXpxkmeNsJkwmsR18RpldDPqIFW890'
          event_name: ${{ github.actor }}
          data: '${{ needs.list-files.outputs.paths }}'
      

